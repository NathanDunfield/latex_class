% Setting up theorems, figures, etc. Note: tried to get cleveref to work,
% but proved too flaky to be worth it.  
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{nmd/thm}[2014/08/31 - Semester start edition]
\RequirePackage{nmd/common}
\RequirePackage{thmtools}
\RequirePackage{thm-restate}

% define needed keyval key if necessary
\ifthen{\isundefined{\KV@thmdef@nmd}}%
   {\define@key{thmdef}{nmd}[{}]{}}

% Theorem number should be first!  
\swapnumbers

% In AMS article, let's use slanted instead of italics in theorems
\@ifclassloaded{amsart}
   {\newtheoremstyle{plain}{}{}{\slshape}{}{\bfseries}{.}{0.5em}{}}
   {}
  
\newcommand{\nmdnewtheorem}[1]{%
  \declaretheorem[nmd, style=plain, sibling=subsection]{#1}}

\nmdnewtheorem{theorem}
\nmdnewtheorem{conjecture}
\nmdnewtheorem{lemma}
\nmdnewtheorem{corollary}
\nmdnewtheorem{proposition}
\nmdnewtheorem{claim}
\nmdnewtheorem{question}
\nmdnewtheorem{goal}
\nmdnewtheorem{criterion}
\nmdnewtheorem{project}

\declaretheorem[style=definition, sibling=subsection]{definition}
\declaretheorem[style=definition, sibling=subsection]{notation}
\declaretheorem[style=remark, sibling=subsection]{remark}
\declaretheorem[style=remark, sibling=subsection]{example}

% Change enum to use letters, so there's no confusion 
% with equation labels.  I'm not really happy with this. 

\renewcommand{\labelenumi}{(\alph{enumi}) }
\renewcommand{\theenumi}{\alph{enumi}}

% Figures and tables 
\RequirePackage{booktabs}
\RequirePackage[margin=15pt,font=small,labelfont=bf, labelsep=period]{caption} 
\RequirePackage[margin=15pt,font=small,labelfont=bf, labelsep=period]{subfig}

% Put figures, tables, and equations onto the common
% subsection/theorem counter. There ought to be a better 
% way to equate two counters than this, but...

\let\c@figure=\c@subsection
\let\thefigure=\thesubsection
\let\c@table=\c@subsection
\let\thetable=\thesubsection
\let\c@equation=\c@subsection
\let\theequation=\thesubsection